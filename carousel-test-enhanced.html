<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FloresYa - Enhanced Carousel Test</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Enhanced Carousel CSS -->
    <link rel="stylesheet" href="/frontend/css/carousel.css">
    <style>
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            background: linear-gradient(135deg, #ffeef8 0%, #f8f9fa 100%);
        }
        .test-header {
            background: linear-gradient(135deg, #FF69B4, #FF1493);
            color: white;
            padding: 3rem 0;
            margin-bottom: 3rem;
        }
        .test-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-success { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-warning { background: #ffc107; }
        .status-info { background: #007bff; }
    </style>
</head>
<body>
    <div class="test-header">
        <div class="container">
            <div class="row">
                <div class="col-12 text-center">
                    <h1 class="display-4 fw-bold">ðŸŒ¸ FloresYa Enhanced Carousel Test</h1>
                    <p class="lead">Professional carousel implementation with industry standards</p>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Test Status -->
        <div class="test-section">
            <h2 class="h4 fw-bold mb-3">
                <i class="bi bi-speedometer2 me-2"></i>Test Status
            </h2>
            <div class="row">
                <div class="col-md-6">
                    <div id="bootstrap-status" class="mb-2">
                        <span class="status-indicator status-warning"></span>
                        <span>Bootstrap: Loading...</span>
                    </div>
                    <div id="carousel-service-status" class="mb-2">
                        <span class="status-indicator status-warning"></span>
                        <span>Carousel Service: Loading...</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div id="carousel-init-status" class="mb-2">
                        <span class="status-indicator status-info"></span>
                        <span>Carousel Initialization: Pending</span>
                    </div>
                    <div id="images-status" class="mb-2">
                        <span class="status-indicator status-info"></span>
                        <span>Images: Pending</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Carousel Container -->
        <div class="test-section">
            <h2 class="h4 fw-bold mb-3">
                <i class="bi bi-camera-reels me-2"></i>Professional Carousel
            </h2>
            <div class="carousel-container">
                <div id="dynamicCarousel" class="mb-3">
                    <!-- Carousel will be initialized here -->
                </div>
            </div>
            
            <!-- Carousel Controls -->
            <div class="row mt-3">
                <div class="col-12">
                    <h5>Manual Controls</h5>
                    <div class="btn-group" role="group">
                        <button type="button" class="btn btn-outline-primary" onclick="testPrev()">
                            <i class="bi bi-arrow-left"></i> Previous
                        </button>
                        <button type="button" class="btn btn-outline-primary" onclick="testPlay()">
                            <i class="bi bi-play"></i> Play
                        </button>
                        <button type="button" class="btn btn-outline-primary" onclick="testPause()">
                            <i class="bi bi-pause"></i> Pause
                        </button>
                        <button type="button" class="btn btn-outline-primary" onclick="testNext()">
                            <i class="bi bi-arrow-right"></i> Next
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Images -->
        <div class="test-section">
            <h2 class="h4 fw-bold mb-3">
                <i class="bi bi-images me-2"></i>Test Different Image Sets
            </h2>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <button class="btn btn-success w-100" onclick="loadTestImages('flowers')">
                        <i class="bi bi-flower1 me-2"></i>Load Flower Images
                    </button>
                </div>
                <div class="col-md-4 mb-3">
                    <button class="btn btn-info w-100" onclick="loadTestImages('placeholder')">
                        <i class="bi bi-image me-2"></i>Load Placeholder Images
                    </button>
                </div>
                <div class="col-md-4 mb-3">
                    <button class="btn btn-warning w-100" onclick="loadTestImages('empty')">
                        <i class="bi bi-exclamation-triangle me-2"></i>Test Empty State
                    </button>
                </div>
            </div>
        </div>

        <!-- Debug Information -->
        <div class="test-section">
            <h2 class="h4 fw-bold mb-3">
                <i class="bi bi-bug me-2"></i>Debug Information
            </h2>
            <div class="row">
                <div class="col-12">
                    <div id="debug-info" class="bg-light p-3 rounded">
                        <small class="text-muted">Debug information will appear here...</small>
                    </div>
                </div>
            </div>
            <div class="mt-3">
                <button class="btn btn-outline-secondary" onclick="toggleDebug()">
                    <i class="bi bi-terminal me-2"></i>Toggle Debug Mode
                </button>
                <button class="btn btn-outline-info" onclick="getCarouselState()">
                    <i class="bi bi-info-circle me-2"></i>Get Carousel State
                </button>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Carousel Service -->
    <script src="/frontend/js/carousel.js"></script>

    <script>
        // Test data
        const testImageSets = {
            flowers: [
                {
                    id: '1',
                    image_url: 'https://images.unsplash.com/photo-1518709268805-4e9042af2176?w=900&h=500&fit=crop&crop=center',
                    title: 'Beautiful Rose Bouquet',
                    description: 'Fresh red roses for special occasions',
                    alt_text: 'Red roses bouquet',
                    display_order: 0
                },
                {
                    id: '2',
                    image_url: 'https://images.unsplash.com/photo-1563241527-3004b7be0ffd?w=900&h=500&fit=crop&crop=center',
                    title: 'Sunflower Field',
                    description: 'Bright yellow sunflowers in bloom',
                    alt_text: 'Sunflower field',
                    display_order: 1
                },
                {
                    id: '3',
                    image_url: 'https://images.unsplash.com/photo-1490750967868-88aa4486c946?w=900&h=500&fit=crop&crop=center',
                    title: 'Mixed Flower Arrangement',
                    description: 'Colorful mixed flower bouquet',
                    alt_text: 'Mixed flowers',
                    display_order: 2
                }
            ],
            placeholder: [
                {
                    id: '4',
                    image_url: 'https://via.placeholder.com/900x500/FF69B4/FFFFFF?text=FloresYa+Image+1',
                    title: 'Placeholder Image 1',
                    description: 'Test placeholder for carousel functionality',
                    alt_text: 'Placeholder 1'
                },
                {
                    id: '5',
                    image_url: 'https://via.placeholder.com/900x500/FF1493/FFFFFF?text=FloresYa+Image+2',
                    title: 'Placeholder Image 2',
                    description: 'Another test placeholder',
                    alt_text: 'Placeholder 2'
                }
            ],
            empty: []
        };

        // Status update functions
        function updateStatus(elementId, status, message) {
            const element = document.getElementById(elementId);
            if (element) {
                const statusIndicator = element.querySelector('.status-indicator');
                const textNode = element.querySelector('span:last-child');
                
                statusIndicator.className = `status-indicator status-${status}`;
                textNode.textContent = message;
            }
        }

        function updateDebugInfo(info) {
            const debugElement = document.getElementById('debug-info');
            if (debugElement) {
                debugElement.innerHTML = `<pre>${JSON.stringify(info, null, 2)}</pre>`;
            }
        }

        // Carousel control functions
        function testPrev() {
            if (window.carouselService) {
                window.carouselService.prev();
                updateDebugInfo({ action: 'Previous slide triggered', timestamp: new Date().toISOString() });
            }
        }

        function testNext() {
            if (window.carouselService) {
                window.carouselService.next();
                updateDebugInfo({ action: 'Next slide triggered', timestamp: new Date().toISOString() });
            }
        }

        function testPlay() {
            if (window.carouselService) {
                window.carouselService.play();
                updateDebugInfo({ action: 'Carousel play triggered', timestamp: new Date().toISOString() });
            }
        }

        function testPause() {
            if (window.carouselService) {
                window.carouselService.pause();
                updateDebugInfo({ action: 'Carousel pause triggered', timestamp: new Date().toISOString() });
            }
        }

        function getCarouselState() {
            if (window.carouselService) {
                const state = window.carouselService.getState();
                updateDebugInfo({ 
                    action: 'Carousel state retrieved', 
                    timestamp: new Date().toISOString(),
                    state: state 
                });
            }
        }

        function toggleDebug() {
            const current = localStorage.getItem('floresya-debug') === 'true';
            localStorage.setItem('floresya-debug', (!current).toString());
            window.floresyaDebug = !current;
            updateDebugInfo({ 
                action: 'Debug mode toggled', 
                debugMode: !current,
                timestamp: new Date().toISOString() 
            });
        }

        // Load different image sets
        async function loadTestImages(setName) {
            const images = testImageSets[setName];
            updateStatus('images-status', 'warning', `Loading ${setName} images...`);
            
            try {
                const success = await window.carouselService.initialize('dynamicCarousel', images);
                
                if (success) {
                    updateStatus('images-status', 'success', `Loaded ${images.length} ${setName} images`);
                    updateStatus('carousel-init-status', 'success', 'Carousel initialized successfully');
                } else {
                    updateStatus('images-status', 'warning', `Loaded ${setName} with fallback`);
                    updateStatus('carousel-init-status', 'warning', 'Carousel initialized with fallback');
                }
                
                updateDebugInfo({
                    action: `Loaded ${setName} images`,
                    imageCount: images.length,
                    success: success,
                    timestamp: new Date().toISOString()
                });
            } catch (error) {
                updateStatus('images-status', 'error', `Error loading ${setName} images`);
                updateStatus('carousel-init-status', 'error', 'Carousel initialization failed');
                updateDebugInfo({
                    action: `Failed to load ${setName} images`,
                    error: error.message,
                    timestamp: new Date().toISOString()
                });
            }
        }

        // Initialize test page
        document.addEventListener('DOMContentLoaded', function() {
            console.log('[ðŸŒ¸ Test Page] DOM loaded, initializing tests...');
            
            // Check Bootstrap availability
            if (typeof bootstrap !== 'undefined') {
                updateStatus('bootstrap-status', 'success', 'Bootstrap: Available');
            } else {
                updateStatus('bootstrap-status', 'error', 'Bootstrap: Not available');
            }
            
            // Check carousel service availability
            if (window.carouselService) {
                updateStatus('carousel-service-status', 'success', 'Carousel Service: Available');
                
                // Load default flower images
                setTimeout(() => {
                    loadTestImages('flowers');
                }, 1000);
            } else {
                updateStatus('carousel-service-status', 'error', 'Carousel Service: Not available');
            }
            
            // Enable debug mode for testing
            localStorage.setItem('floresya-debug', 'true');
            window.floresyaDebug = true;
            
            updateDebugInfo({
                message: 'Test page initialized',
                timestamp: new Date().toISOString(),
                userAgent: navigator.userAgent,
                viewport: {
                    width: window.innerWidth,
                    height: window.innerHeight
                }
            });
        });
        
        // Window resize handler for responsive testing
        window.addEventListener('resize', function() {
            updateDebugInfo({
                action: 'Window resized',
                viewport: {
                    width: window.innerWidth,
                    height: window.innerHeight
                },
                timestamp: new Date().toISOString()
            });
        });
    </script>
</body>
</html>