<!DOCTYPE html>
<html>
<head>
    <title>Test Imagen Simple</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        img { max-width: 300px; border: 2px solid #ddd; margin: 10px; }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>🧪 Test de Imágenes - FloresYa</h1>
    
    <div class="test-section">
        <h2>1. Test de URL directa</h2>
        <p>URL: https://dcbavpdlkcjdtjdkntde.supabase.co/storage/v1/object/public/product-images/large/arreglo-de-mesa-elegante-1-large.webp</p>
        <img src="https://dcbavpdlkcjdtjdkntde.supabase.co/storage/v1/object/public/product-images/large/arreglo-de-mesa-elegante-1-large.webp" 
             alt="Test directo" 
             onload="console.log('✅ Imagen cargó correctamente')" 
             onerror="console.log('❌ Error cargando imagen')">
    </div>

    <div class="test-section">
        <h2>2. Test con API</h2>
        <div id="api-test">Cargando desde API...</div>
    </div>

    <div class="test-section">
        <h2>3. Console log</h2>
        <div id="console-log">Revisa la consola del navegador para más detalles</div>
    </div>

    <script>
        console.log('🚀 Iniciando tests...');
        
        // Test 2: Cargar desde API
        fetch('/api/products/1')
            .then(response => response.json())
            .then(data => {
                console.log('📊 Datos del producto:', data);
                
                if (data.success && data.data.image_url) {
                    const apiTest = document.getElementById('api-test');
                    apiTest.innerHTML = `
                        <p>URL desde API: ${data.data.image_url}</p>
                        <img src="${data.data.image_url}" 
                             alt="${data.data.name}" 
                             onload="console.log('✅ Imagen desde API cargó')" 
                             onerror="console.log('❌ Error imagen desde API')">
                    `;
                } else {
                    document.getElementById('api-test').innerHTML = '❌ Error en API';
                }
            })
            .catch(error => {
                console.error('❌ Error en fetch:', error);
                document.getElementById('api-test').innerHTML = '❌ Error: ' + error.message;
            });

        // Test de conectividad
        console.log('🌐 Probando conectividad a Supabase...');
        fetch('https://dcbavpdlkcjdtjdkntde.supabase.co/storage/v1/object/public/product-images/large/arreglo-de-mesa-elegante-1-large.webp', {
            method: 'HEAD'
        })
        .then(response => {
            console.log('📊 Status de conectividad:', response.status);
            console.log('📋 Headers:', Object.fromEntries(response.headers));
        })
        .catch(error => {
            console.error('❌ Error de conectividad:', error);
        });
    </script>
</body>
</html>