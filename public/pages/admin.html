<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Panel de Administración - FloresYa">
    <title>Panel de Administración - FloresYa</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/admin.css">
    <link rel="stylesheet" href="/css/scroll-fix.css">

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/images/favicon.ico">

    <style>
        /* 🚨 CRITICAL: Prevent FOUC - Loading overlay must be visible immediately */
        #loadingOverlay {
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(255,255,255,0.9) !important;
            display: flex !important;
            justify-content: center !important;
            align-items: center !important;
            z-index: 9999 !important;
        }

        /* Admin Panel Styles */
        .admin-sidebar {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
        }

        .admin-content {
            min-height: 100vh;
            background-color: #f8f9fa;
        }

        .sidebar-brand {
            padding: 1.5rem;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-brand h4 {
            color: white;
            margin: 0;
            font-weight: 700;
        }

        .sidebar-nav .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            margin: 0.25rem 1rem;
            transition: all 0.3s ease;
        }

        .sidebar-nav .nav-link:hover {
            color: white;
            background-color: rgba(255,255,255,0.1);
            transform: translateX(5px);
        }

        .sidebar-nav .nav-link.active {
            color: white;
            background-color: rgba(255,105,180,0.8);
            box-shadow: 0 4px 15px rgba(255,105,180,0.3);
        }

        .sidebar-nav .nav-link i {
            width: 20px;
            margin-right: 10px;
        }

        .admin-header {
            background: white;
            border-bottom: 1px solid #e9ecef;
            padding: 1rem 2rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .admin-card {
            border: none;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .admin-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .metric-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .metric-card.success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        }

        .metric-card.warning {
            background: linear-gradient(135deg, #fcb045 0%, #fd1d1d 100%);
        }

        .metric-card.info {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .table-responsive {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.07);
        }

        .btn-admin {
            border-radius: 8px;
            font-weight: 600;
            padding: 0.5rem 1.5rem;
            transition: all 0.3s ease;
        }

        .btn-admin:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .status-active {
            background-color: #d4edda;
            color: #155724;
        }

        .status-inactive {
            background-color: #f8d7da;
            color: #721c24;
        }

        .status-pending {
            background-color: #fff3cd;
            color: #856404;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .admin-sidebar {
                position: fixed;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .admin-sidebar.show {
                transform: translateX(0);
            }

            .admin-content {
                margin-left: 0;
            }
        }

        /* 🚨 FALLBACK MODE STYLES 🚨 */
        .fallback-mode {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            padding: 2rem 0;
        }

        .fallback-alert {
            max-width: 800px;
            margin: 0 auto;
            border: 2px solid #ffc107;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        }

        .fallback-alert .alert-heading {
            color: #856404;
            font-weight: 600;
        }

        .fallback-retry-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .fallback-retry-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
            background: linear-gradient(135deg, #218838 0%, #17a2b8 100%);
        }

        /* Emergency visibility styles */
        .emergency-visible {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        /* Force show content even with CSS issues */
        .force-show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            min-height: 400px;
        }

        /* 🚨 CRITICAL MODAL FIX 🚨 */
        .modal.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
        }

        .modal.fade.show {
            opacity: 1 !important;
            visibility: visible !important;
            transition: none !important;
        }

        /* Force modal to be visible when it has the show class */
        #productModal.modal.show,
        #testBootstrapModal.modal.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 1055 !important;
        }

        /* Fix modal backdrop */
        .modal-backdrop.show {
            opacity: 0.5 !important;
            z-index: 1050 !important;
        }

        /* 🎯 CAROUSEL POSITION INTERFACE STYLES 🎯 */
        .carousel-position-container {
            border: 1px solid #dee2e6;
            border-radius: 0.375rem;
            padding: 1rem;
            background-color: #f8f9fa;
            max-height: 400px;
            overflow-y: auto;
        }

        .carousel-option {
            margin-bottom: 0.75rem;
            padding: 0.5rem;
            border-radius: 0.25rem;
            transition: background-color 0.2s;
        }

        .carousel-option:hover {
            background-color: #e9ecef;
        }

        .carousel-option.occupied {
            background-color: #fff5f5;
            border-left: 4px solid #dc3545;
        }

        .carousel-option.available {
            background-color: #f0fff4;
            border-left: 4px solid #28a745;
        }

        .carousel-option .form-check-label {
            width: 100%;
            cursor: pointer;
            font-weight: 500;
        }

        .carousel-option .position-text {
            flex-grow: 1;
            padding-right: 0.5rem;
        }

        .carousel-option small {
            font-size: 0.75rem;
            font-weight: normal;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .carousel-position-container {
                max-height: 300px;
                padding: 0.75rem;
            }

            .carousel-option {
                margin-bottom: 0.5rem;
                padding: 0.375rem;
            }

            .carousel-option .form-check-label {
                font-size: 0.9rem;
            }

            .carousel-option .btn-sm {
                font-size: 0.75rem;
                padding: 0.2rem 0.4rem;
            }

            .position-text {
                word-break: break-word;
            }
        }

        /* Ensure text doesn't overflow */
        .carousel-option .position-text {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        @media (max-width: 576px) {
            .carousel-option .position-text {
                white-space: normal;
                overflow: visible;
            }
        }

        /* 🌸 USER CREATION MODAL STYLING 🌸 */

        /* Modal Background and Container */
        #userModal .modal-content {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 20px 50px rgba(102, 126, 234, 0.15);
            background: linear-gradient(145deg, #ffffff 0%, #f0f2ff 100%);
            overflow: hidden;
        }

        #userModal .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-bottom: none;
            padding: 1.5rem 2rem;
            border-radius: 1rem 1rem 0 0;
        }

        #userModal .modal-title {
            font-weight: 600;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
        }

        #userModal .modal-title::before {
            content: "👤";
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        #userModal .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
        }

        #userModal .btn-close:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        #userModal .modal-body {
            padding: 2rem;
            background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
        }

        /* Form Styling */
        #userModal .form-label {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        #userModal .form-control,
        #userModal .form-select {
            border: 2px solid #d1d5ff;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
            background-color: #ffffff;
        }

        #userModal .form-control:focus,
        #userModal .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.15);
            background-color: #ffffff;
        }

        #userModal .form-text {
            color: #764ba2;
            font-size: 0.8rem;
            font-style: italic;
        }

        /* Password strength indicator */
        .password-strength {
            margin-top: 0.5rem;
            font-size: 0.8rem;
        }

        .password-strength.weak {
            color: #dc3545;
        }

        .password-strength.medium {
            color: #ffc107;
        }

        .password-strength.strong {
            color: #28a745;
        }

        /* Buttons Styling */
        #userModal .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #userModal .btn-primary:hover {
            background: linear-gradient(135deg, #5a6fd8 0%, #6a4190 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
        }

        #userModal .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #868e96 100%);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #userModal .btn-secondary:hover {
            background: linear-gradient(135deg, #545b62 0%, #6c757d 100%);
            transform: translateY(-2px);
        }

        /* Message Area Styling */
        #userModal .alert {
            border: none;
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            font-weight: 500;
        }

        #userModal .alert-success {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            color: #1b5e20;
            border-left: 4px solid #4caf50;
        }

        #userModal .alert-danger {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
            border-left: 4px solid #ffc107;
            border: 1px solid #ffeaa7;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            #userModal .modal-body {
                padding: 1.5rem;
            }
        }

        /* 🔧 FIX OCCASION SELECT CONTRAST 🔧 */
        .form-select option {
            background-color: #ffffff !important;
            color: #212529 !important;
            padding: 8px !important;
        }

        .form-select option:checked,
        .form-select option:hover,
        .form-select option:focus {
            background-color: #0d6efd !important;
            color: #ffffff !important;
            font-weight: 600 !important;
        }

        /* Ensure select text is visible and has good contrast */
        .form-select {
            color: #212529 !important;
            background-color: #ffffff !important;
            border: 2px solid #dee2e6 !important;
            font-weight: 500 !important;
        }

        .form-select:focus {
            border-color: #0d6efd !important;
            box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25) !important;
            color: #212529 !important;
            background-color: #ffffff !important;
        }

        /* Specific fix for selected option visibility */
        .form-select option[selected] {
            background-color: #e7f3ff !important;
            color: #0d6efd !important;
            font-weight: 600 !important;
        }

        /* 🌿 PRODUCT MODAL PREMIUM STYLING - VERDE ESMERALDA 🌿 */

        /* Modal Background and Container */
        #productModal .modal-content {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 20px 50px rgba(46, 125, 50, 0.15);
            background: linear-gradient(145deg, #ffffff 0%, #e8f5e8 100%);
            overflow: hidden;
        }

        #productModal .modal-header {
            background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            color: white;
            border-bottom: none;
            padding: 1.5rem 2rem;
            border-radius: 1rem 1rem 0 0;
        }

        #productModal .modal-title {
            font-weight: 600;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
        }

        #productModal .modal-title::before {
            content: "🌸";
            margin-right: 0.5rem;
            font-size: 1.1rem;
        }

        #productModal .btn-close {
            filter: brightness(0) invert(1);
            opacity: 0.8;
        }

        #productModal .btn-close:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        #productModal .modal-body {
            padding: 2rem;
            background: linear-gradient(145deg, #ffffff 0%, #f1f8e9 100%);
        }

        /* Form Styling */
        #productModal .form-label {
            font-weight: 600;
            color: #2e7d32;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        #productModal .form-control,
        #productModal .form-select {
            border: 2px solid #c8e6c9;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
            background-color: #ffffff;
        }

        #productModal .form-control:focus,
        #productModal .form-select:focus {
            border-color: #2e7d32;
            box-shadow: 0 0 0 0.2rem rgba(46, 125, 50, 0.15);
            background-color: #ffffff;
        }

        #productModal .form-text {
            color: #4caf50;
            font-size: 0.8rem;
            font-style: italic;
        }

        /* 🎯 OCCASIONS CHECKBOXES PREMIUM STYLING 🎯 */
        .occasions-checkboxes {
            max-height: 200px;
            overflow-y: auto;
            border: 2px solid #c8e6c9;
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            background: linear-gradient(145deg, #ffffff 0%, #f1f8e9 100%);
            box-shadow: inset 0 2px 8px rgba(46, 125, 50, 0.05);
        }

        .occasions-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .occasions-list .form-check {
            margin-bottom: 0;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            background-color: transparent;
        }

        .occasions-list .form-check:hover {
            background-color: rgba(46, 125, 50, 0.05);
            transform: translateX(4px);
        }

        .occasions-list .form-check-input {
            margin-top: 0.25rem;
            border: 2px solid #4caf50;
            border-radius: 0.25rem;
            width: 1.1rem;
            height: 1.1rem;
        }

        .occasions-list .form-check-input:checked {
            background-color: #2e7d32;
            border-color: #2e7d32;
        }

        .occasions-list .form-check-input:focus {
            box-shadow: 0 0 0 0.2rem rgba(46, 125, 50, 0.25);
        }

        .occasions-list .form-check-label {
            font-weight: 500;
            color: #495057;
            cursor: pointer;
            margin-left: 0.5rem;
            line-height: 1.4;
        }

        .occasions-list .form-check-label small {
            font-weight: 400;
            font-style: italic;
            color: #6c757d;
        }

        .occasions-list .form-check-input:checked + .form-check-label {
            color: #2e7d32;
            font-weight: 600;
        }

        /* 📻 CAROUSEL RADIO BUTTONS OPTIMIZATION 📻 */
        .carousel-positions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 0.75rem;
            padding: 1rem;
            background: linear-gradient(145deg, #ffffff 0%, #f1f8e9 100%);
            border: 2px solid #c8e6c9;
            border-radius: 0.75rem;
            box-shadow: inset 0 2px 8px rgba(46, 125, 50, 0.05);
        }

        .carousel-position {
            display: flex;
            align-items: center;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
            background-color: transparent;
            min-height: 2.5rem;
        }

        .carousel-position:hover {
            background-color: rgba(46, 125, 50, 0.05);
            transform: translateY(-1px);
        }

        .carousel-position input[type="radio"] {
            margin-right: 0.75rem;
            border: 2px solid #4caf50;
            width: 1.1rem;
            height: 1.1rem;
        }

        .carousel-position input[type="radio"]:checked {
            background-color: #2e7d32;
            border-color: #2e7d32;
        }

        .carousel-position label {
            font-weight: 500;
            color: #495057;
            cursor: pointer;
            margin: 0;
            line-height: 1.4;
        }

        .carousel-position input[type="radio"]:checked + label {
            color: #2e7d32;
            font-weight: 600;
        }

        /* Buttons Styling */
        #productModal .btn-primary {
            background: linear-gradient(135deg, #2e7d32 0%, #4caf50 100%);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #productModal .btn-primary:hover {
            background: linear-gradient(135deg, #1b5e20 0%, #2e7d32 100%);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(46, 125, 50, 0.3);
        }

        #productModal .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #868e96 100%);
            border: none;
            border-radius: 0.5rem;
            padding: 0.75rem 2rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #productModal .btn-secondary:hover {
            background: linear-gradient(135deg, #545b62 0%, #6c757d 100%);
            transform: translateY(-2px);
        }

        /* Message Area Styling */
        #productModal .alert {
            border: none;
            border-radius: 0.75rem;
            padding: 1rem 1.25rem;
            font-weight: 500;
        }

        #productModal .alert-success {
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            color: #1b5e20;
            border-left: 4px solid #2e7d32;
        }

        #productModal .alert-danger {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            color: #856404;
            border-left: 4px solid #ffc107;
            border: 1px solid #ffeaa7;
        }

        /* Custom Scrollbar for occasions panel */
        .occasions-checkboxes::-webkit-scrollbar {
            width: 6px;
        }

        .occasions-checkboxes::-webkit-scrollbar-track {
            background: #c8e6c9;
            border-radius: 3px;
        }

        .occasions-checkboxes::-webkit-scrollbar-thumb {
            background: #2e7d32;
            border-radius: 3px;
        }

        .occasions-checkboxes::-webkit-scrollbar-thumb:hover {
            background: #1b5e20;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            #productModal .modal-body {
                padding: 1.5rem;
            }

            .carousel-positions {
                grid-template-columns: 1fr;
            }

            .occasions-checkboxes {
                max-height: 150px;
                padding: 0.75rem 1rem;
            }
        }

        /* Force modal to be visible when it has the show class */
        #userModal.modal.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 1055 !important;
        }

        /* 🖼️ PRODUCT IMAGES MODAL PREMIUM STYLING 🖼️ */

        /* Modal Background and Container */
        #productImagesModal .modal-content {
            border: none;
            border-radius: 1rem;
            box-shadow: 0 20px 50px rgba(0, 123, 255, 0.15);
            background: linear-gradient(145deg, #ffffff 0%, #f0f8ff 100%);
            overflow: hidden;
        }

        #productImagesModal .modal-header {
            background: linear-gradient(135deg, #198754 0%, #20c997 100%);
            color: white;
            border-bottom: none;
            padding: 1.5rem 2rem;
            border-radius: 1rem 1rem 0 0;
        }

        #productImagesModal .modal-title {
            font-weight: 600;
            font-size: 1.25rem;
            display: flex;
            align-items: center;
        }

        #productImagesModal .modal-body {
            padding: 2rem;
            background: linear-gradient(145deg, #ffffff 0%, #f8fffa 100%);
            max-height: 80vh;
            overflow-y: auto;
        }

        /* Form Controls Styling */
        #productImagesModal .form-label {
            font-weight: 600;
            color: #198754;
            margin-bottom: 0.5rem;
            font-size: 0.9rem;
        }

        #productImagesModal .form-control,
        #productImagesModal .form-select {
            border: 2px solid #d1ecf1;
            border-radius: 0.5rem;
            padding: 0.75rem 1rem;
            transition: all 0.3s ease;
            background-color: #ffffff;
        }

        #productImagesModal .form-control:focus,
        #productImagesModal .form-select:focus {
            border-color: #198754;
            box-shadow: 0 0 0 0.2rem rgba(25, 135, 84, 0.15);
            background-color: #ffffff;
        }

        /* Upload Section Styling */
        #productImagesModal .card {
            border: 2px solid #d1ecf1;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(25, 135, 84, 0.1);
            transition: box-shadow 0.3s ease;
        }

        #productImagesModal .card:hover {
            box-shadow: 0 8px 15px rgba(25, 135, 84, 0.15);
        }

        #productImagesModal .card-header {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9f7ef 100%);
            border-bottom: 2px solid #d1ecf1;
            font-weight: 600;
        }

        /* Progress Bar Styling */
        #productImagesModal .progress {
            height: 8px;
            border-radius: 10px;
            background-color: #e9ecef;
        }

        #productImagesModal .progress-bar {
            background: linear-gradient(90deg, #198754 0%, #20c997 100%);
            border-radius: 10px;
            transition: width 0.6s ease;
        }

        /* Images Gallery Styling */
        .product-image-card {
            border: 2px solid #e9ecef;
            border-radius: 0.75rem;
            overflow: hidden;
            transition: all 0.3s ease;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .product-image-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(25, 135, 84, 0.2);
            border-color: #198754;
        }

        .product-image-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .product-image-card:hover img {
            transform: scale(1.05);
        }

        .product-image-card .card-body {
            padding: 1rem;
        }

        .product-image-card .badge {
            font-size: 0.75rem;
            padding: 0.35rem 0.65rem;
        }

        .product-image-card .badge.bg-primary {
            background: linear-gradient(135deg, #0d6efd 0%, #6610f2 100%) !important;
        }

        .product-image-card .badge.bg-success {
            background: linear-gradient(135deg, #198754 0%, #20c997 100%) !important;
        }

        .product-image-card .badge.bg-warning {
            background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%) !important;
        }

        /* Image Actions */
        .image-actions {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 0.5rem;
            padding: 0.25rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .product-image-card:hover .image-actions {
            opacity: 1;
        }

        .image-actions .btn {
            width: 2rem;
            height: 2rem;
            padding: 0;
            margin: 0.1rem;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        /* List view styling */
        .images-list-view .product-image-card {
            display: flex;
            flex-direction: row;
            margin-bottom: 1rem;
        }

        .images-list-view .product-image-card img {
            width: 150px;
            height: 150px;
            flex-shrink: 0;
        }

        .images-list-view .product-image-card .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        /* View mode buttons */
        .btn-group .btn.active {
            background-color: #198754 !important;
            border-color: #198754 !important;
            color: white !important;
        }

        /* Loading and empty states */
        #productImagesModal .spinner-border {
            color: #198754;
        }

        /* Pagination styling */
        #productImagesModal .pagination .page-link {
            color: #198754;
            border-color: #d1ecf1;
        }

        #productImagesModal .pagination .page-link:hover {
            color: #ffffff;
            background-color: #198754;
            border-color: #198754;
        }

        #productImagesModal .pagination .page-item.active .page-link {
            background-color: #198754;
            border-color: #198754;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            #productImagesModal .modal-body {
                padding: 1rem;
            }

            .product-image-card img {
                height: 150px;
            }

            .images-list-view .product-image-card {
                flex-direction: column;
            }

            .images-list-view .product-image-card img {
                width: 100%;
                height: 200px;
            }
        }

        /* Force modal to be visible when it has the show class */
        #productImagesModal.modal.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 1055 !important;
        }

        /* 🌸 ENHANCED ORDERS MANAGEMENT STYLES 🌸 */

        /* Orders Stats Cards */
        #ordersStatsRow .metric-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        #ordersStatsRow .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        /* Orders Table Enhancements */
        #ordersTable {
            font-size: 0.875rem;
        }

        #ordersTable thead th {
            font-weight: 600;
            color: #495057;
            border-bottom: 2px solid #dee2e6;
            padding: 0.75rem 0.5rem;
        }

        #ordersTable tbody td {
            padding: 0.75rem 0.5rem;
            vertical-align: middle;
        }

        /* Order Status Badges */
        .order-status-pending {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .order-status-confirmed {
            background-color: #cce5ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }

        .order-status-preparing {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .order-status-ready {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .order-status-delivered {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .order-status-cancelled {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* Order Actions */
        .order-actions .btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.75rem;
            margin: 0.125rem;
        }

        /* Quick Status Update */
        .status-update-dropdown .dropdown-item {
            padding: 0.5rem 1rem;
        }

        .status-update-dropdown .dropdown-item:hover {
            background-color: #f8f9fa;
        }

        .status-update-dropdown .dropdown-item i {
            width: 16px;
            margin-right: 8px;
        }

        /* Order Details Modal */
        #orderDetailsModal .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        #orderDetailsModal .card {
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border: none;
            border-radius: 0.5rem;
        }

        #orderDetailsModal .card-header {
            font-weight: 600;
            border-bottom: 1px solid rgba(0,0,0,0.125);
        }

        /* Order Items Table */
        #orderItemsTableBody .product-info {
            display: flex;
            align-items: center;
        }

        #orderItemsTableBody .product-image {
            width: 40px;
            height: 40px;
            object-fit: cover;
            border-radius: 0.25rem;
            margin-right: 0.75rem;
            border: 1px solid #dee2e6;
        }

        /* Status History */
        .status-history-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            border-left: 4px solid #dee2e6;
            margin-bottom: 0.5rem;
            background-color: #f8f9fa;
            border-radius: 0.25rem;
        }

        .status-history-item.current {
            border-left-color: #28a745;
            background-color: #d4edda;
        }

        .status-history-item .status-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            font-size: 0.875rem;
        }

        .status-history-item .status-content {
            flex: 1;
        }

        .status-history-item .status-time {
            font-size: 0.75rem;
            color: #6c757d;
        }

        /* Loading States */
        .orders-loading {
            text-align: center;
            padding: 2rem;
        }

        .orders-loading .spinner-border {
            width: 2rem;
            height: 2rem;
        }

        /* Empty States */
        .orders-empty {
            text-align: center;
            padding: 3rem 2rem;
            color: #6c757d;
        }

        .orders-empty i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }

        /* Filters */
        #ordersFilterInfo {
            font-size: 0.875rem;
        }

        /* Pagination */
        #ordersPagination .pagination .page-link {
            color: #667eea;
            border-color: #dee2e6;
        }

        #ordersPagination .pagination .page-link:hover {
            color: #764ba2;
            background-color: #e9ecef;
            border-color: #adb5bd;
        }

        #ordersPagination .pagination .page-item.active .page-link {
            background-color: #667eea;
            border-color: #667eea;
        }

        /* Responsive adjustments for orders */
        @media (max-width: 768px) {
            #ordersStatsRow .col-md-2 {
                margin-bottom: 1rem;
            }

            #ordersTable {
                font-size: 0.75rem;
            }

            #ordersTable thead th,
            #ordersTable tbody td {
                padding: 0.5rem 0.25rem;
            }

            .order-actions {
                display: flex;
                flex-direction: column;
                gap: 0.25rem;
            }

            .order-actions .btn {
                padding: 0.375rem 0.5rem;
                font-size: 0.75rem;
            }
        }

        /* Force order details modal to be visible */
        #orderDetailsModal.modal.show {
            display: block !important;
            visibility: visible !important;
            opacity: 1 !important;
            z-index: 1055 !important;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="text-center">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Cargando...</span>
            </div>
            <div class="mt-2">
                <strong>Cargando panel de administración...</strong>
            </div>
        </div>
    </div>

    <div class="container-fluid" id="adminPanel">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 px-0 admin-sidebar" id="adminSidebar">
                <div class="sidebar-brand">
                    <h4>
                        <i class="bi bi-shield-check me-2"></i>
                        Admin Panel
                    </h4>
                </div>

                <nav class="sidebar-nav">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#dashboard" data-section="dashboard">
                                <i class="bi bi-speedometer2"></i>
                                Dashboard
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#products" data-section="products">
                                <i class="bi bi-box-seam"></i>
                                Productos
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#orders" data-section="orders">
                                <i class="bi bi-receipt"></i>
                                Pedidos
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#users" data-section="users">
                                <i class="bi bi-people"></i>
                                Usuarios
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#occasions" data-section="occasions">
                                <i class="bi bi-calendar-event"></i>
                                Ocasiones
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#settings" data-section="settings">
                                <i class="bi bi-gear"></i>
                                Configuración
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#images" data-section="images">
                                <i class="bi bi-images"></i>
                                Imágenes
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#logs" data-section="logs">
                                <i class="bi bi-journal-text"></i>
                                Logs
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#schema" data-section="schema">
                                <i class="bi bi-diagram-3"></i>
                                Esquema DB
                            </a>
                        </li>
                        <li class="nav-item mt-3">
                            <a class="nav-link text-warning" href="/" id="backToSite">
                                <i class="bi bi-arrow-left"></i>
                                Volver al sitio
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-danger" href="#" id="logoutBtn">
                                <i class="bi bi-box-arrow-right"></i>
                                Cerrar sesión
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 px-0 admin-content">
                <!-- Header -->
                <header class="admin-header">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h5 class="mb-0" id="pageTitle">Dashboard</h5>
                            <small class="text-muted" id="pageSubtitle">Vista general del sistema</small>
                        </div>
                        <div class="d-flex align-items-center">
                            <span class="badge bg-primary me-3" id="userRole">Administrador</span>
                            <button class="btn btn-outline-secondary btn-sm d-md-none" id="sidebarToggle">
                                <i class="bi bi-list"></i>
                            </button>
                        </div>
                    </div>
                </header>

                <!-- Content Area -->
                <main class="p-4">
                    <!-- Dashboard Section -->
                    <div id="dashboard-section" class="admin-section active">
                        <div class="row mb-4">
                            <div class="col-md-3 mb-3">
                                <div class="card admin-card metric-card">
                                    <div class="card-body text-center">
                                        <i class="bi bi-box-seam display-4 mb-2"></i>
                                        <h3 class="card-title" id="totalProducts">0</h3>
                                        <p class="card-text">Productos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card admin-card metric-card success">
                                    <div class="card-body text-center">
                                        <i class="bi bi-receipt display-4 mb-2"></i>
                                        <h3 class="card-title" id="totalOrders">0</h3>
                                        <p class="card-text">Pedidos</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card admin-card metric-card warning">
                                    <div class="card-body text-center">
                                        <i class="bi bi-people display-4 mb-2"></i>
                                        <h3 class="card-title" id="totalUsers">0</h3>
                                        <p class="card-text">Usuarios</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="card admin-card metric-card info">
                                    <div class="card-body text-center">
                                        <i class="bi bi-graph-up display-4 mb-2"></i>
                                        <h3 class="card-title" id="totalRevenue">$0</h3>
                                        <p class="card-text">Ingresos</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-4">
                                <div class="card admin-card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="bi bi-exclamation-triangle text-warning me-2"></i>
                                            Alertas Recientes
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="alertsList">
                                            <p class="text-muted mb-0">Cargando alertas...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6 mb-4">
                                <div class="card admin-card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="bi bi-activity text-success me-2"></i>
                                            Actividad Reciente
                                        </h6>
                                    </div>
                                    <div class="card-body">
                                        <div id="recentActivity">
                                            <p class="text-muted mb-0">Cargando actividad...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Section -->
                    <div id="products-section" class="admin-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Gestión de Productos</h4>
                            <button class="btn btn-primary btn-admin" id="addProductBtn">
                                <i class="bi bi-plus-circle me-2"></i>
                                Nuevo Producto
                            </button>
                        </div>

                        <div class="card admin-card">
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="productsTable">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Precio</th>
                                                <th>Stock</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="productsTableBody">
                                            <tr>
                                                <td colspan="6" class="text-center text-muted">
                                                    Cargando productos...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Orders Section -->
                    <div id="orders-section" class="admin-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <div>
                                <h4 class="mb-1">
                                    <i class="bi bi-receipt me-2"></i>Gestión de Pedidos
                                </h4>
                                <small class="text-muted">Administra órdenes de compra y estados de entrega</small>
                            </div>
                            <div class="d-flex gap-2">
                                <button class="btn btn-outline-primary btn-sm" id="refreshOrdersBtn">
                                    <i class="bi bi-arrow-clockwise me-1"></i>Actualizar
                                </button>
                                <button class="btn btn-primary btn-sm" id="exportOrdersBtn">
                                    <i class="bi bi-download me-1"></i>Exportar
                                </button>
                            </div>
                        </div>

                        <!-- Orders Stats Cards -->
                        <div class="row mb-4" id="ordersStatsRow">
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-clock display-6 mb-2 text-warning"></i>
                                        <h6 class="card-title mb-1" id="pendingOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Pendientes</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card info">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-check-circle display-6 mb-2 text-info"></i>
                                        <h6 class="card-title mb-1" id="confirmedOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Confirmados</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card warning">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-gear display-6 mb-2 text-warning"></i>
                                        <h6 class="card-title mb-1" id="preparingOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Preparando</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-box-seam display-6 mb-2 text-primary"></i>
                                        <h6 class="card-title mb-1" id="readyOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Listos</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card success">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-truck display-6 mb-2 text-success"></i>
                                        <h6 class="card-title mb-1" id="deliveredOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Entregados</small>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-2 mb-3">
                                <div class="card admin-card metric-card">
                                    <div class="card-body text-center p-3">
                                        <i class="bi bi-x-circle display-6 mb-2 text-danger"></i>
                                        <h6 class="card-title mb-1" id="cancelledOrdersCount">0</h6>
                                        <small class="card-text text-white-50">Cancelados</small>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Filters and Search -->
                        <div class="card admin-card mb-4">
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-3">
                                        <label for="ordersStatusFilter" class="form-label">Estado</label>
                                        <select class="form-select form-select-sm" id="ordersStatusFilter">
                                            <option value="">Todos los estados</option>
                                            <option value="pending">Pendiente</option>
                                            <option value="confirmed">Confirmado</option>
                                            <option value="preparing">Preparando</option>
                                            <option value="ready">Listo</option>
                                            <option value="delivered">Entregado</option>
                                            <option value="cancelled">Cancelado</option>
                                        </select>
                                    </div>
                                    <div class="col-md-3">
                                        <label for="ordersDateFrom" class="form-label">Desde</label>
                                        <input type="date" class="form-control form-control-sm" id="ordersDateFrom">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="ordersDateTo" class="form-label">Hasta</label>
                                        <input type="date" class="form-control form-control-sm" id="ordersDateTo">
                                    </div>
                                    <div class="col-md-3">
                                        <label for="ordersSearch" class="form-label">Buscar</label>
                                        <div class="input-group input-group-sm">
                                            <input type="text" class="form-control" id="ordersSearch" placeholder="Cliente, email, ID...">
                                            <button class="btn btn-outline-secondary" type="button" id="ordersSearchBtn">
                                                <i class="bi bi-search"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex justify-content-between align-items-center mt-3">
                                    <small class="text-muted" id="ordersFilterInfo">Mostrando todos los pedidos</small>
                                    <div class="d-flex gap-2">
                                        <select class="form-select form-select-sm" id="ordersSortBy" style="width: auto;">
                                            <option value="created_at">Fecha</option>
                                            <option value="total_amount_usd">Total</option>
                                            <option value="status">Estado</option>
                                            <option value="customer_name">Cliente</option>
                                        </select>
                                        <select class="form-select form-select-sm" id="ordersSortDirection" style="width: auto;">
                                            <option value="desc">↓ Descendente</option>
                                            <option value="asc">↑ Ascendente</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Orders Table -->
                        <div class="card admin-card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="mb-0">
                                    <i class="bi bi-table me-2"></i>Pedidos
                                </h6>
                                <small class="text-muted" id="ordersCount">0 pedidos</small>
                            </div>
                            <div class="card-body p-0">
                                <div class="table-responsive">
                                    <table class="table table-hover mb-0" id="ordersTable">
                                        <thead class="table-light">
                                            <tr>
                                                <th class="border-0">#</th>
                                                <th class="border-0">Cliente</th>
                                                <th class="border-0">Productos</th>
                                                <th class="border-0">Total</th>
                                                <th class="border-0">Estado</th>
                                                <th class="border-0">Fecha</th>
                                                <th class="border-0">Entrega</th>
                                                <th class="border-0">Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="ordersTableBody">
                                            <tr id="ordersLoadingRow">
                                                <td colspan="8" class="text-center py-4">
                                                    <div class="spinner-border spinner-border-sm text-primary me-2" role="status"></div>
                                                    Cargando pedidos...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <!-- Pagination -->
                            <div class="card-footer" id="ordersPagination" style="display: none;">
                                <div class="d-flex justify-content-between align-items-center">
                                    <small class="text-muted" id="ordersPaginationInfo">Mostrando 1-10 de 50 pedidos</small>
                                    <nav aria-label="Paginación de pedidos">
                                        <ul class="pagination pagination-sm mb-0" id="ordersPaginationControls">
                                            <!-- Pagination controls will be generated here -->
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Users Section -->
                    <div id="users-section" class="admin-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Gestión de Usuarios</h4>
                            <button class="btn btn-success btn-admin" id="addUserBtn">
                                <i class="bi bi-person-plus me-2"></i>
                                Nuevo Usuario
                            </button>
                        </div>

                        <div class="card admin-card">
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="usersTable">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Email</th>
                                                <th>Rol</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="usersTableBody">
                                            <tr>
                                                <td colspan="6" class="text-center text-muted">
                                                    Cargando usuarios...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Occasions Section -->
                    <div id="occasions-section" class="admin-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Gestión de Ocasiones</h4>
                            <button class="btn btn-info btn-admin" id="addOccasionBtn">
                                <i class="bi bi-calendar-plus me-2"></i>
                                Nueva Ocasión
                            </button>
                        </div>

                        <div class="card admin-card">
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="occasionsTable">
                                        <thead>
                                            <tr>
                                                <th>ID</th>
                                                <th>Nombre</th>
                                                <th>Tipo</th>
                                                <th>Orden</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="occasionsTableBody">
                                            <tr>
                                                <td colspan="6" class="text-center text-muted">
                                                    Cargando ocasiones...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Settings Section -->
                    <div id="settings-section" class="admin-section" style="display: none;">
                        <h4>Configuración del Sistema</h4>
                        <div class="card admin-card">
                            <div class="card-body">
                                <p class="text-muted">Configuración del sistema próximamente...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Images Section -->
                    <div id="images-section" class="admin-section" style="display: none;">
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Gestión de Imágenes de Productos</h4>
                            <div class="btn-group">
                                <button class="btn btn-primary btn-admin" id="uploadSiteImagesBtn">
                                    <i class="bi bi-cloud-upload me-2"></i>
                                    Subir Imágenes del Sitio
                                </button>
                                <button class="btn btn-success btn-admin" id="manageProductImagesBtn">
                                    <i class="bi bi-images me-2"></i>
                                    Ver Galería de Imágenes
                                </button>
                            </div>
                        </div>

                        <!-- Filters and Sorting Controls -->
                        <div class="row mb-3">
                            <div class="col-md-2">
                                <label for="productStatusFilter" class="form-label">Estado del Producto:</label>
                                <select class="form-select" id="productStatusFilter">
                                    <option value="active">Activos</option>
                                    <option value="inactive">No Activos</option>
                                    <option value="all">Todos</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="imageStatusFilter" class="form-label">Estado de Imágenes:</label>
                                <select class="form-select" id="imageStatusFilter">
                                    <option value="active">Activas</option>
                                    <option value="inactive">No Activas</option>
                                    <option value="all">Todas</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="productOccasionFilter" class="form-label">Ocación:</label>
                                <select class="form-select" id="productOccasionFilter">
                                    <option value="general">Sin ocasión específica</option>
                                    <!-- Occasions will be loaded here alphabetically -->
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label for="sortImagesSelect" class="form-label">Ordenar por:</label>
                                <select class="form-select" id="sortImagesSelect">
                                    <option value="image_count">Cantidad de imágenes (menor a mayor)</option>
                                    <option value="name_asc">Nombre (A-Z)</option>
                                    <option value="name_desc">Nombre (Z-A)</option>
                                </select>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button class="btn btn-outline-primary w-100" id="applyFiltersBtn">
                                    <i class="bi bi-funnel me-1"></i>Aplicar Filtros
                                </button>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button class="btn btn-outline-secondary w-100" id="resetFiltersBtn">
                                    <i class="bi bi-arrow-counterclockwise me-1"></i>Reiniciar
                                </button>
                            </div>
                        </div>

                        <!-- Products Table -->
                        <div class="card admin-card">
                            <div class="card-header">
                                <h6 class="mb-0">
                                    <i class="bi bi-table me-2"></i>
                                    Productos y sus Imágenes
                                </h6>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover" id="productsImagesTable">
                                        <thead>
                                            <tr>
                                                <th>Nombre del Producto</th>
                                                <th>Precio</th>
                                                <th>Cantidad de Imágenes</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="productsImagesTableBody">
                                            <tr>
                                                <td colspan="4" class="text-center text-muted">
                                                    <i class="bi bi-hourglass-split me-2"></i>
                                                    Cargando productos...
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Site Images Management -->
                        <div class="row mb-4">
                            <div class="col-md-6">
                                <div class="card admin-card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="bi bi-image text-primary me-2"></i>
                                            Imagen Hero
                                        </h6>
                                    </div>
                                    <div class="card-body text-center">
                                        <div id="heroImagePreview" class="mb-3">
                                            <img src="/images/hero-flowers.webp" alt="Hero Image" class="img-fluid rounded shadow-sm" style="max-height: 150px;">
                                        </div>
                                        <button class="btn btn-outline-primary btn-sm" id="changeHeroImageBtn">
                                            <i class="bi bi-pencil me-1"></i>
                                            Cambiar Imagen Hero
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="card admin-card">
                                    <div class="card-header">
                                        <h6 class="mb-0">
                                            <i class="bi bi-badge-tm text-success me-2"></i>
                                            Logo del Sitio
                                        </h6>
                                    </div>
                                    <div class="card-body text-center">
                                        <div id="logoPreview" class="mb-3">
                                            <img src="/images/logoFloresYa.jpeg" alt="Site Logo" class="img-fluid rounded shadow-sm" style="max-height: 80px;">
                                        </div>
                                        <button class="btn btn-outline-success btn-sm" id="changeLogoBtn">
                                            <i class="bi bi-pencil me-1"></i>
                                            Cambiar Logo
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Product Images Gallery -->
                        <div class="card admin-card">
                            <div class="card-header d-flex justify-content-between align-items-center">
                                <h6 class="mb-0">
                                    <i class="bi bi-grid-3x3-gap text-info me-2"></i>
                                    Galería de Imágenes de Productos
                                </h6>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-secondary" id="filterAllImages">Todas</button>
                                    <button class="btn btn-outline-secondary" id="filterUnusedImages">Sin usar</button>
                                    <button class="btn btn-outline-secondary" id="filterProductImages">En uso</button>
                                </div>
                            </div>
                            <div class="card-body">
                                <div id="imagesGallery" class="row">
                                    <!-- Images will be loaded here -->
                                    <div class="col-12 text-center text-muted py-5">
                                        <i class="bi bi-images display-1 mb-3"></i>
                                        <p>Cargando galería de imágenes...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Logs Section -->
                    <div id="logs-section" class="admin-section" style="display: none;">
                        <h4>Logs del Sistema</h4>
                        <div class="card admin-card">
                            <div class="card-body">
                                <p class="text-muted">Sistema de logs próximamente...</p>
                            </div>
                        </div>
                    </div>

                    <!-- Schema Section -->
                    <div id="schema-section" class="admin-section" style="display: none;">
                        <h4>
                            <i class="bi bi-diagram-3 me-2"></i>
                            Esquema de Base de Datos
                        </h4>

                        <div class="row mb-3">
                            <div class="col-12">
                                <div class="btn-group" role="group">
                                    <button type="button" class="btn btn-primary" id="loadSchemaInfo">
                                        <i class="bi bi-info-circle me-2"></i>
                                        Ver Estadísticas
                                    </button>
                                    <button type="button" class="btn btn-success" id="viewSchemaSQL">
                                        <i class="bi bi-eye me-2"></i>
                                        Ver Esquema
                                    </button>
                                    <button type="button" class="btn btn-warning" id="updateSchemaFile">
                                        <i class="bi bi-arrow-clockwise me-2"></i>
                                        Actualizar Archivo
                                    </button>
                                    <button type="button" class="btn btn-info" id="downloadSchemaSQL">
                                        <i class="bi bi-download me-2"></i>
                                        Descargar SQL
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Schema Stats Card -->
                        <div class="card admin-card mb-4" id="schemaStatsCard" style="display: none;">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-graph-up me-2"></i>
                                    Estadísticas del Esquema
                                </h5>
                            </div>
                            <div class="card-body" id="schemaStatsContent">
                                <!-- Content will be loaded here -->
                            </div>
                        </div>

                        <!-- Schema SQL Card -->
                        <div class="card admin-card" id="schemaSQLCard" style="display: none;">
                            <div class="card-header">
                                <h5 class="mb-0">
                                    <i class="bi bi-code-slash me-2"></i>
                                    SQL Schema Completo
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="position-relative">
                                    <button type="button" class="btn btn-sm btn-outline-secondary position-absolute top-0 end-0 mt-2 me-2" id="copySchemaSQLBtn">
                                        <i class="bi bi-clipboard"></i>
                                        Copiar
                                    </button>
                                    <pre><code id="schemaSQLContent" class="language-sql" style="max-height: 500px; overflow-y: auto; font-size: 0.85rem; line-height: 1.4;">
<!-- SQL Content will be loaded here -->
                                    </code></pre>
                                </div>
                            </div>
                        </div>

                        <!-- Loading Indicator -->
                        <div class="text-center py-4" id="schemaLoadingIndicator" style="display: none;">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Cargando...</span>
                            </div>
                            <p class="mt-2 text-muted">Extrayendo esquema de la base de datos...</p>
                        </div>

                        <!-- Error Alert -->
                        <div class="alert alert-danger" role="alert" id="schemaErrorAlert" style="display: none;">
                            <i class="bi bi-exclamation-triangle me-2"></i>
                            <span id="schemaErrorMessage">Error al cargar el esquema</span>
                        </div>

                        <!-- Success Alert -->
                        <div class="alert alert-success" role="alert" id="schemaSuccessAlert" style="display: none;">
                            <i class="bi bi-check-circle me-2"></i>
                            <span id="schemaSuccessMessage">Operación completada exitosamente</span>
                        </div>
                    </div>
                </main>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Force UI visibility after proper initialization -->
    <script>
        // Better timing for overlay hiding - let initialization complete first
        document.addEventListener("DOMContentLoaded", function() {
            // Wait a bit to allow proper initialization
            setTimeout(() => {
                const overlay = document.getElementById('loadingOverlay');
                if (overlay && overlay.style.display !== 'none') {
                    overlay.style.display = 'none';
                    console.log('[🌸 Admin] ✅ Loading overlay ocultado después de inicialización.');

                    // Ensure dashboard is visible
                    const dashboardSection = document.getElementById('dashboard-section');
                    if (dashboardSection) {
                        dashboardSection.style.display = 'block';
                        dashboardSection.classList.add('active');
                        console.log('[🌸 Admin] ✅ Dashboard section forzado a visible');
                    }
                }
            }, 500); // Give 500ms for proper initialization
        });

        // 🚨 DIAGNOSTIC FUNCTIONS - Remove in production
        window.testModalDirectly = function() {
            console.log('🧪 Testing modal creation directly...');

            const modalHtml = `
                <div class="modal fade" id="testModal" tabindex="-1">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title">Test Modal</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <p>Este es un modal de prueba creado directamente.</p>
                                <form id="testForm">
                                    <div class="mb-3">
                                        <label for="testName" class="form-label">Nombre</label>
                                        <input type="text" class="form-control" id="testName" required>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                                <button type="button" class="btn btn-primary" id="testSaveBtn">Guardar</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing test modal
            const existing = document.getElementById('testModal');
            if (existing) existing.remove();

            // Add to body
            document.body.insertAdjacentHTML('beforeend', modalHtml);

            // Try to show with Bootstrap
            const modalElement = document.getElementById('testModal');
            if (modalElement && window.bootstrap && window.bootstrap.Modal) {
                const Modal = window.bootstrap.Modal;
                const modal = new Modal(modalElement);
                modal.show();
                console.log('✅ Test modal shown with Bootstrap');
            } else {
                // Fallback without Bootstrap
                if (modalElement) {
                    modalElement.style.display = 'block';
                    modalElement.style.position = 'fixed';
                    modalElement.style.top = '0';
                    modalElement.style.left = '0';
                    modalElement.style.width = '100%';
                    modalElement.style.height = '100%';
                    modalElement.style.backgroundColor = 'rgba(0,0,0,0.5)';
                    modalElement.style.zIndex = '9999';
                    console.log('✅ Test modal shown with fallback');
                }
            }
        };

        window.forceShowProductsSection = function() {
            console.log('🚨 Forzando mostrar sección de productos...');

            // Hide all sections
            document.querySelectorAll('.admin-section').forEach(sec => {
                sec.style.display = 'none';
                sec.classList.remove('active');
            });

            // Show products section
            const productsSection = document.getElementById('products-section');
            if (productsSection) {
                productsSection.style.display = 'block';
                productsSection.classList.add('active');
                console.log('✅ Products section forced visible');

                // Update sidebar active state
                document.querySelectorAll('.sidebar-nav .nav-link').forEach(link => {
                    link.classList.remove('active');
                });
                const productsLink = document.querySelector('[data-section="products"]');
                if (productsLink) {
                    productsLink.classList.add('active');
                }
            } else {
                console.log('❌ Products section not found');
            }
        };

        console.log('🔧 Funciones de diagnóstico disponibles:');
        console.log('   - testModalDirectly() - Probar modal básico');
        console.log('   - forceShowProductsSection() - Forzar mostrar productos');
        console.log('   - adminPanel.diagnose() - Diagnóstico completo (después de carga)');
    </script>

    <!-- Custom Admin JavaScript with Robust Fallback System -->
    <script type="module">
        // 🚨 ROBUST ADMIN PANEL INITIALIZATION SYSTEM 🚨
        // This ensures the interface ALWAYS shows, even with errors

        let initializationAttempts = 0;
        const MAX_ATTEMPTS = 3;
        let emergencyFallbackTimer = null;
        const MAX_INIT_TIME = 10000; // 10 seconds max

        // Force show interface after timeout
        const forceShowInterface = () => {
            console.log('[🌸 Admin] ⏰ Force showing interface after timeout');
            hideLoadingOverlay();
            showFallbackInterface();
        };

        // Hide loading overlay
        const hideLoadingOverlay = () => {
            const overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                console.log('[🌸 Admin] 🔍 Loading overlay state BEFORE hiding:', {
                    display: overlay.style.display,
                    visible: overlay.style.display !== 'none',
                    computed: window.getComputedStyle(overlay).display
                });

                overlay.style.display = 'none';

                console.log('[🌸 Admin] 🔍 Loading overlay state AFTER hiding:', {
                    display: overlay.style.display,
                    visible: overlay.style.display !== 'none',
                    computed: window.getComputedStyle(overlay).display
                });

                console.log('[🌸 Admin] ✅ Loading overlay hidden');
            } else {
                console.log('[🌸 Admin] ⚠️ Loading overlay element not found!');
            }
        };

        // Show fallback interface
        const showFallbackInterface = () => {
            console.log('[🌸 Admin] 🔧 Showing fallback interface');

            // Force show main content area
            const mainContent = document.querySelector('.admin-content main');
            if (mainContent) {
                mainContent.classList.add('force-show');
                mainContent.innerHTML = `
                    <div class="container-fluid fallback-mode">
                        <div class="row justify-content-center">
                            <div class="col-md-8 col-lg-6">
                                <div class="card admin-card fallback-alert">
                                    <div class="card-body text-center">
                                        <div class="mb-4">
                                            <i class="bi bi-exclamation-triangle display-1 text-warning"></i>
                                        </div>

                                        <h4 class="alert-heading mb-3">
                                            <i class="bi bi-shield-check me-2"></i>Modo de Recuperación Activado
                                        </h4>

                                        <p class="text-muted mb-4">
                                            El panel de administración se cargó en modo básico debido a un problema técnico.
                                            Todas las funciones críticas están disponibles.
                                        </p>

                                        <div class="alert alert-info text-start mb-4">
                                            <h6 class="alert-heading mb-2">
                                                <i class="bi bi-info-circle me-2"></i>Estado del Sistema:
                                            </h6>
                                            <ul class="mb-0">
                                                <li>✅ Interfaz visible y funcional</li>
                                                <li>✅ Navegación operativa</li>
                                                <li>✅ Autenticación básica activa</li>
                                                <li>⚠️ Funciones avanzadas limitadas</li>
                                            </ul>
                                        </div>

                                        <div class="mb-4">
                                            <h6>¿Qué puedes hacer?</h6>
                                            <ul class="text-start">
                                                <li>Refresca la página (F5) para intentar recargar completamente</li>
                                                <li>Verifica tu conexión a internet</li>
                                                <li>Las funciones básicas siguen disponibles</li>
                                                <li>Contacta al administrador si el problema persiste</li>
                                            </ul>
                                        </div>

                                        <div class="d-flex gap-2 justify-content-center">
                                            <button onclick="location.reload()" class="btn fallback-retry-btn">
                                                <i class="bi bi-arrow-clockwise me-2"></i>Recargar Página
                                            </button>
                                            <button onclick="window.history.back()" class="btn btn-outline-secondary">
                                                <i class="bi bi-arrow-left me-2"></i>Volver Atrás
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                console.log('[🌸 Admin] ✅ Fallback interface displayed');
            }

            // Ensure sidebar is visible
            const sidebar = document.getElementById('adminSidebar');
            if (sidebar) {
                sidebar.classList.add('emergency-visible');
            }
        };

        // Main initialization function with error handling
        async function initializeAdminPanel() {
            console.log('[🌸 Admin] 🚀 Starting robust initialization...');

            // Set timeout to force show interface
            const timeoutId = setTimeout(forceShowInterface, MAX_INIT_TIME);

            try {
                initializationAttempts++;
                console.log(`[🌸 Admin] 📊 Attempt ${initializationAttempts}/${MAX_ATTEMPTS}`);

                // Dynamic import with error handling - COMPILED JavaScript FILE
                const module = await import('/dist/frontend/admin.js');
                console.log('[🌸 Admin] ✅ Module loaded successfully');

                const AdminPanel = module.AdminPanel;
                const adminPanel = new AdminPanel();

                console.log('[🌸 Admin] 🔄 Initializing admin panel...');
                await adminPanel.init();

                // Success - clear timeout and hide overlay
                clearTimeout(timeoutId);
                hideLoadingOverlay();
                console.log('[🌸 Admin] 🎉 Admin panel initialized successfully!');

                // CRITICAL: Cancel emergency fallback timer since initialization succeeded
                if (emergencyFallbackTimer) {
                    clearTimeout(emergencyFallbackTimer);
                    emergencyFallbackTimer = null;
                    console.log('[🌸 Admin] ✅ Emergency fallback timer canceled - initialization successful');
                }

            } catch (error) {
                console.error(`[🌸 Admin] ❌ Attempt ${initializationAttempts} failed:`, error);

                // Clear timeout for this attempt
                clearTimeout(timeoutId);

                // If we haven't exceeded max attempts, try again
                if (initializationAttempts < MAX_ATTEMPTS) {
                    console.log(`[🌸 Admin] 🔄 Retrying in 2 seconds... (${initializationAttempts}/${MAX_ATTEMPTS})`);
                    setTimeout(initializeAdminPanel, 2000);
                } else {
                    // Max attempts reached - show fallback
                    console.log('[🌸 Admin] 💥 Max attempts reached, showing fallback interface');
                    hideLoadingOverlay();
                    showFallbackInterface();
                }
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => {
                console.log('[🌸 Admin] 📄 DOM loaded, starting initialization');
                initializeAdminPanel();
            });
        } else {
            console.log('[🌸 Admin] 📄 DOM already loaded, starting initialization');
            initializeAdminPanel();
        }

        // Emergency fallback - show interface after 15 seconds no matter what
        console.log('[🌸 Admin] ⏰ Setting emergency fallback timer for 15 seconds');
        emergencyFallbackTimer = setTimeout(() => {
            console.log('[🌸 Admin] 🚨 Emergency fallback triggered - 15 seconds elapsed');

            // Add detailed diagnostic before triggering fallback
            const currentState = {
                initializationAttempts,
                adminPanelExists: !!window.adminPanel,
                adminPanelVisible: window.adminPanel && typeof window.adminPanel.isVisible === 'function' ? window.adminPanel.isVisible() : 'unknown',
                loadingOverlayState: document.getElementById('loadingOverlay')?.style.display,
                loadingOverlayVisible: document.getElementById('loadingOverlay')?.style.display !== 'none',
                mainContentExists: !!document.getElementById('main-content'),
                mainContentVisible: document.getElementById('main-content')?.style.display !== 'none',
                dashboardExists: !!document.getElementById('dashboard-section'),
                dashboardVisible: document.getElementById('dashboard-section')?.style.display !== 'none',
                mainContentInnerHTML: document.querySelector('.admin-content main')?.innerHTML?.length || 0
            };

            console.log('[🌸 Admin] 🔍 Critical state at emergency fallback trigger:', currentState);

            hideLoadingOverlay();
            const mainContent = document.querySelector('.admin-content main');
            console.log('[🌸 Admin] 🔍 Main content check for fallback:', {
                exists: !!mainContent,
                innerHTML: mainContent?.innerHTML?.trim() || '',
                shouldShowFallback: mainContent && mainContent.innerHTML.trim() === ''
            });

            if (mainContent && mainContent.innerHTML.trim() === '') {
                console.log('[🌸 Admin] 💥 Showing fallback interface - main content is empty');
                showFallbackInterface();
            } else {
                console.log('[🌸 Admin] ✅ Main content exists, NOT showing fallback interface');
            }
        }, 15000);

        console.log('[🌸 Admin] ⏰ Emergency fallback timer ID:', emergencyFallbackTimer);

        // 🔍 ADVANCED DIAGNOSTIC FUNCTIONS 🔍

        // Check if the admin.js module is accessible
        window.checkAdminModule = async function() {
            console.log('🔍 === DIAGNÓSTICO DE MÓDULO ADMIN ===');

            try {
                console.log('📦 Intentando cargar módulo admin.js...');
                const startTime = Date.now();

                const module = await import('/dist/frontend/admin.js');
                const loadTime = Date.now() - startTime;

                console.log(`✅ Módulo cargado exitosamente en ${loadTime}ms`);
                console.log('📋 Contenido del módulo:', module);

                if (module.AdminPanel) {
                    console.log('✅ AdminPanel class encontrada');
                    const testInstance = new module.AdminPanel();
                    console.log('✅ Instancia de AdminPanel creada:', testInstance);
                } else {
                    console.log('❌ AdminPanel class NO encontrada en el módulo');
                }

            } catch (error) {
                console.log('❌ Error cargando módulo admin.js:', error);
                console.log('🔍 Detalles del error:', {
                    name: error.name,
                    message: error.message,
                    stack: error.stack
                });
            }

            console.log('=====================================');
        };

        // Force show basic interface (bypass all JavaScript)
        window.forceShowInterface = function() {
            console.log('🚨 FORZANDO MUESTRA DE INTERFAZ BÁSICA');

            // Hide loading overlay
            hideLoadingOverlay();

            // Show basic interface
            const mainContent = document.querySelector('.admin-content main');
            if (mainContent) {
                mainContent.innerHTML = `
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-12">
                                <div class="alert alert-success">
                                    <h4><i class="bi bi-check-circle me-2"></i>Interfaz Básica Activada</h4>
                                    <p>Panel de administración cargado en modo básico de emergencia.</p>
                                    <hr>
                                    <p><strong>Funciones disponibles:</strong></p>
                                    <ul>
                                        <li>✅ Navegación visible</li>
                                        <li>✅ Logout funcional</li>
                                        <li>✅ Volver al sitio</li>
                                        <li>⚠️ Funciones avanzadas deshabilitadas</li>
                                    </ul>
                                </div>

                                <div class="row mt-4">
                                    <div class="col-md-4 mb-3">
                                        <div class="card admin-card">
                                            <div class="card-body text-center">
                                                <i class="bi bi-house-door display-4 text-primary mb-3"></i>
                                                <h5>Dashboard</h5>
                                                <p class="text-muted">Vista general (modo básico)</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="card admin-card">
                                            <div class="card-body text-center">
                                                <i class="bi bi-box-seam display-4 text-success mb-3"></i>
                                                <h5>Productos</h5>
                                                <p class="text-muted">Próximamente</p>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="card admin-card">
                                            <div class="card-body text-center">
                                                <i class="bi bi-people display-4 text-info mb-3"></i>
                                                <h5>Usuarios</h5>
                                                <p class="text-muted">Próximamente</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                mainContent.classList.add('emergency-visible');
            }

            console.log('✅ Interfaz básica mostrada exitosamente');
        };

        // Auto-diagnostic on load
        setTimeout(() => {
            const hasContent = document.querySelector('.admin-content main')?.innerHTML.trim();
            if (!hasContent || hasContent === '') {
                console.log('⚠️ No se detectó contenido en el panel, ejecutando diagnóstico automático...');
                window.checkAdminModule();
            }
        }, 3000);

        // 🚨 SYSTEM HEALTH CHECK 🚨
        window.systemHealthCheck = function() {
            console.log('🔍 === VERIFICACIÓN DE SALUD DEL SISTEMA ===');

            // Enhanced sidebar visibility check
            const sidebar = document.getElementById('adminSidebar');
            const sidebarVisible = sidebar && window.getComputedStyle(sidebar).display !== 'none' && window.getComputedStyle(sidebar).visibility !== 'hidden';

            const checks = {
                'DOM Ready': document.readyState === 'complete',
                'Loading Overlay Hidden': document.getElementById('loadingOverlay')?.style.display === 'none',
                'Main Content': !!document.querySelector('.admin-content main'),
                'Sidebar Element Exists': !!document.getElementById('adminSidebar'),
                'Sidebar Visible': sidebarVisible,
                'Navigation': !!document.querySelector('.sidebar-nav'),
                'CSS Loaded': !!document.styleSheets.length,
                'JavaScript Loaded': typeof window !== 'undefined',
                'Console Available': typeof console !== 'undefined'
            };

            let allPassed = true;
            for (const [check, passed] of Object.entries(checks)) {
                const status = passed ? '✅' : '❌';
                console.log(`${status} ${check}: ${passed}`);
                if (!passed) allPassed = false;
            }

            console.log(`\n🏥 Estado General: ${allPassed ? '✅ SISTEMA SALUDABLE' : '❌ PROBLEMAS DETECTADOS'}`);

            if (!allPassed) {
                console.log('\n💡 RECOMENDACIONES:');
                console.log('1. Verifica la conexión a internet');
                console.log('2. Recarga la página (F5)');
                console.log('3. Limpia la caché del navegador');
                console.log('4. Ejecuta: forceShowInterface() para activar modo básico');
            }

            console.log('=====================================');
            return allPassed;
        };

        // Auto health check
        setTimeout(() => {
            console.log('🔍 Ejecutando verificación automática de salud del sistema...');
            window.systemHealthCheck();
        }, 1000);

        // � DIAGNOSTIC FUNCTION - Run this in browser console
        window.checkAuthStatus = function() {
            console.log('🔍 === DIAGNÓSTICO DE AUTENTICACIÓN ===');

            const userData = localStorage.getItem('floresya_user');
            const sessionTime = localStorage.getItem('floresya_session');

            console.log('📊 Estado de localStorage:');
            console.log('  - Usuario:', userData ? '✅ Presente' : '❌ Ausente');
            console.log('  - Sesión:', sessionTime ? '✅ Presente' : '❌ Ausente');

            if (userData) {
                try {
                    const user = JSON.parse(userData);
                    console.log('👤 Datos del usuario:');
                    console.log('  - Email:', user.email);
                    console.log('  - Nombre:', user.full_name || user.name || 'N/A');
                    console.log('  - Rol:', user.role);
                    console.log('  - Activo:', user.is_active);

                    if (user.role !== 'admin') {
                        console.log('🚫 PROBLEMA: El usuario no tiene rol de administrador');
                        console.log('💡 SOLUCIÓN: Inicia sesión con admin@floresya.com / admin');
                    } else {
                        console.log('✅ El usuario tiene rol de administrador');
                    }
                } catch (e) {
                    console.log('❌ Error parseando datos del usuario:', e);
                }
            }

            if (sessionTime) {
                const sessionAge = Date.now() - parseInt(sessionTime);
                const hoursOld = Math.floor(sessionAge / (1000 * 60 * 60));
                console.log('⏰ Edad de la sesión:', hoursOld, 'horas');

                if (sessionAge > 24 * 60 * 60 * 1000) {
                    console.log('🚫 PROBLEMA: La sesión ha expirado (más de 24 horas)');
                    console.log('💡 SOLUCIÓN: Inicia sesión nuevamente');
                } else {
                    console.log('✅ La sesión está dentro del tiempo válido');
                }
            }

            console.log('🔗 Para acceder como admin:');
            console.log('  1. Ve a la página principal: http://localhost:3000');
            console.log('  2. Haz click en "Iniciar Sesión"');
            console.log('  3. Usa: admin@floresya.com / admin');
            console.log('  4. O usa el botón rápido "Admin" en el modal de login');

            console.log('=====================================');
        };

        // Auto-run diagnostic if no user data found
        setTimeout(() => {
            const userData = localStorage.getItem('floresya_user');
            if (!userData) {
                console.log('ℹ️ No se encontraron datos de usuario. Ejecuta checkAuthStatus() para diagnóstico.');
            }
        }, 1000);

        // 🔧 MODAL DIAGNOSTIC FUNCTION 🔧
        window.testBootstrapModal = function() {
            console.log('🧪 === TESTING BOOTSTRAP MODAL DIRECTLY ===');

            // Create a simple test modal
            const testModalHtml = `
                <div class="modal fade" id="testBootstrapModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-warning">
                                <h5 class="modal-title">🧪 Test Bootstrap Modal</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <p><strong>¡Modal de prueba funcionando!</strong></p>
                                <p>Si puedes ver esto, Bootstrap Modal está funcionando correctamente.</p>
                                <div class="alert alert-info">
                                    <small>Timestamp: ${new Date().toISOString()}</small>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                                <button type="button" class="btn btn-warning" onclick="alert('Botón de prueba funcionando')">Test Button</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing test modal
            const existing = document.getElementById('testBootstrapModal');
            if (existing) {
                existing.remove();
                console.log('🗑️ Removed existing test modal');
            }

            // Add to body
            document.body.insertAdjacentHTML('beforeend', testModalHtml);
            console.log('✅ Test modal HTML added to body');

            // Try Bootstrap Modal
            const modalElement = document.getElementById('testBootstrapModal');
            if (modalElement && window.bootstrap && window.bootstrap.Modal) {
                try {
                    const modal = new window.bootstrap.Modal(modalElement, {
                        backdrop: true,
                        keyboard: true,
                        focus: true
                    });

                    console.log('✅ Bootstrap Modal instance created');

                    modal.show();
                    console.log('✅ modal.show() called');

                    // FORCE MODAL VISIBILITY - Critical fix
                    setTimeout(() => {
                        const modalToFix = document.getElementById('testBootstrapModal');
                        if (modalToFix) {
                            modalToFix.style.visibility = 'visible';
                            modalToFix.style.opacity = '1';
                            modalToFix.style.display = 'block';
                            modalToFix.classList.add('show');
                            console.log('🔧 FORCED test modal visibility');
                        }
                    }, 50);

                    // Check state after show
                    setTimeout(() => {
                        const style = window.getComputedStyle(modalElement);
                        console.log('🔍 Modal state after show:', {
                            display: style.display,
                            visibility: style.visibility,
                            opacity: style.opacity,
                            zIndex: style.zIndex,
                            position: style.position,
                            top: style.top,
                            left: style.left,
                            transform: style.transform
                        });

                        console.log('🔍 Modal classes:', modalElement.className);

                        const backdrop = document.querySelector('.modal-backdrop');
                        if (backdrop) {
                            const backdropStyle = window.getComputedStyle(backdrop);
                            console.log('🔍 Backdrop found:', {
                                display: backdropStyle.display,
                                zIndex: backdropStyle.zIndex,
                                opacity: backdropStyle.opacity
                            });
                        } else {
                            console.log('❌ No backdrop found');
                        }
                    }, 300);

                } catch (error) {
                    console.error('❌ Error with Bootstrap Modal:', error);
                }
            } else {
                console.log('❌ Bootstrap Modal not available');
                console.log('Bootstrap available:', !!window.bootstrap);
                console.log('Modal class available:', !!(window.bootstrap && window.bootstrap.Modal));
            }

            console.log('======================================');
        };

        // 🎯 CAROUSEL PRODUCT DETAILS FUNCTION 🎯
        window.showCarouselProductDetails = function(productId, productName, productSummary, position) {
            console.log('🔍 Showing product details:', { productId, productName, productSummary, position });

            // Create modal HTML
            const detailsModalHtml = `
                <div class="modal fade" id="carouselProductDetailsModal" tabindex="-1">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header bg-info text-white">
                                <h5 class="modal-title">📋 Producto en Carousel</h5>
                                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body">
                                <div class="mb-3">
                                    <label class="form-label fw-bold">🌹 Nombre del Producto:</label>
                                    <p class="border p-2 bg-light rounded">${productName}</p>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">📍 Posición en Carousel:</label>
                                    <p class="border p-2 bg-light rounded">Posición ${position}</p>
                                </div>

                                <div class="mb-3">
                                    <label class="form-label fw-bold">📝 Resumen:</label>
                                    <p class="border p-2 bg-light rounded" style="max-height: 150px; overflow-y: auto;">
                                        ${productSummary || 'Sin resumen disponible'}
                                    </p>
                                </div>

                                <div class="alert alert-info">
                                    <small>
                                        💡 <strong>Tip:</strong> Para cambiar este producto, selecciona su posición en el formulario principal.
                                    </small>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // Remove existing modal if any
            const existingModal = document.getElementById('carouselProductDetailsModal');
            if (existingModal) {
                existingModal.remove();
            }

            // Add modal to body
            document.body.insertAdjacentHTML('beforeend', detailsModalHtml);

            // Show modal
            const modalElement = document.getElementById('carouselProductDetailsModal');
            if (modalElement && window.bootstrap && window.bootstrap.Modal) {
                try {
                    const modal = new window.bootstrap.Modal(modalElement);
                    modal.show();

                    // Force visibility (same fix as product modal)
                    setTimeout(() => {
                        if (modalElement) {
                            modalElement.style.visibility = 'visible';
                            modalElement.style.opacity = '1';
                            modalElement.style.display = 'block';
                            modalElement.classList.add('show');
                        }
                    }, 50);

                    console.log('✅ Product details modal shown');
                } catch (error) {
                    console.error('❌ Error showing product details modal:', error);
                }
            } else {
                console.log('❌ Bootstrap Modal not available for details');
            }
        };

        // 🔧 SIDEBAR SPECIFIC DIAGNOSTIC FUNCTION 🔧
        window.diagnoseSidebar = function() {
            console.log('🔍 === DIAGNÓSTICO ESPECÍFICO DEL SIDEBAR ===');

            const sidebar = document.getElementById('adminSidebar');
            if (!sidebar) {
                console.log('❌ CRÍTICO: Elemento adminSidebar NO encontrado en el DOM');
                return false;
            }

            console.log('✅ Elemento adminSidebar encontrado');

            // Check all visibility properties
            const computedStyle = window.getComputedStyle(sidebar);
            const inlineStyle = sidebar.style;

            console.log('📊 Propiedades de visibilidad:');
            console.log('  - display (computed):', computedStyle.display);
            console.log('  - display (inline):', inlineStyle.display);
            console.log('  - visibility (computed):', computedStyle.visibility);
            console.log('  - visibility (inline):', inlineStyle.visibility);
            console.log('  - opacity (computed):', computedStyle.opacity);
            console.log('  - opacity (inline):', inlineStyle.opacity);

            console.log('📊 Propiedades de posicionamiento:');
            console.log('  - position (computed):', computedStyle.position);
            console.log('  - position (inline):', inlineStyle.position);
            console.log('  - width (computed):', computedStyle.width);
            console.log('  - width (inline):', inlineStyle.width);
            console.log('  - min-height (computed):', computedStyle.minHeight);
            console.log('  - min-height (inline):', inlineStyle.minHeight);

            console.log('📊 Clases CSS aplicadas:', sidebar.className);

            // Check for conflicting CSS rules
            const conflictingRules = [];
            if (computedStyle.display === 'none') conflictingRules.push('display: none');
            if (computedStyle.visibility === 'hidden') conflictingRules.push('visibility: hidden');
            if (computedStyle.opacity === '0') conflictingRules.push('opacity: 0');
            if (computedStyle.width === '0px') conflictingRules.push('width: 0px');

            if (conflictingRules.length > 0) {
                console.log('⚠️ REGLAS CSS CONFLICTIVAS ENCONTRADAS:', conflictingRules);
            } else {
                console.log('✅ No se encontraron reglas CSS conflictivas');
            }

            // Check parent containers
            const parent = sidebar.parentElement;
            if (parent) {
                const parentStyle = window.getComputedStyle(parent);
                console.log('👨‍👩‍👧‍👦 Contenedor padre:');
                console.log('  - Elemento padre:', parent.tagName + (parent.id ? '#' + parent.id : '') + (parent.className ? '.' + parent.className.split(' ').join('.') : ''));
                console.log('  - Display padre:', parentStyle.display);
                console.log('  - Overflow padre:', parentStyle.overflow);
            }

            // Check if sidebar content is loaded
            const nav = sidebar.querySelector('.sidebar-nav');
            const navItems = sidebar.querySelectorAll('.nav-link');

            console.log('📋 Contenido del sidebar:');
            console.log('  - Navegación encontrada:', !!nav);
            console.log('  - Items de navegación:', navItems.length);

            // Final assessment
            const isVisible = computedStyle.display !== 'none' &&
                            computedStyle.visibility !== 'hidden' &&
                            computedStyle.opacity !== '0' &&
                            computedStyle.width !== '0px';

            console.log(`🏁 RESULTADO FINAL: ${isVisible ? '✅ SIDEBAR VISIBLE' : '❌ SIDEBAR OCULTO'}`);

            if (!isVisible) {
                console.log('💡 POSIBLES SOLUCIONES:');
                console.log('1. Ejecuta: document.getElementById("adminSidebar").style.display = "block"');
                console.log('2. Ejecuta: document.getElementById("adminSidebar").classList.add("emergency-visible")');
                console.log('3. Verifica que no haya CSS que oculte .admin-sidebar');
                console.log('4. Recarga la página completamente (Ctrl+F5)');
            }

            console.log('=====================================');
            return isVisible;
        };

        // Auto-run sidebar diagnostic after initialization
        setTimeout(() => {
            console.log('🔍 Ejecutando diagnóstico automático del sidebar...');
            window.diagnoseSidebar();
        }, 2000);
    </script>

    <!-- Product Images Management Modal -->
    <div class="modal fade" id="productImagesModal" tabindex="-1" aria-labelledby="productImagesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="productImagesModalLabel">
                        <i class="bi bi-images me-2"></i>Gestionar Imágenes de Productos
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Message Area -->
                    <div id="productImagesMessageArea" class="alert-container mb-3" style="display: none;">
                        <div id="productImagesMessage" class="alert" role="alert"></div>
                    </div>

                    <!-- Filter Controls -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <label for="productFilter" class="form-label">Filtrar por Producto</label>
                            <select class="form-select" id="productFilter">
                                <option value="">Todos los productos</option>
                                <!-- Products will be loaded here -->
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="sizeFilter" class="form-label">Tamaño de Imagen</label>
                            <select class="form-select" id="sizeFilter">
                                <option value="">Todos los tamaños</option>
                                <option value="large">Grande (1200x1200)</option>
                                <option value="medium">Mediana (600x600)</option>
                                <option value="small">Pequeña (300x300)</option>
                                <option value="thumb">Miniatura (150x150)</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label for="statusFilter" class="form-label">Estado</label>
                            <select class="form-select" id="statusFilter">
                                <option value="">Todas</option>
                                <option value="primary">Imagen Principal</option>
                                <option value="secondary">Imagen Secundaria</option>
                            </select>
                        </div>
                        <div class="col-md-2 d-flex align-items-end">
                            <button class="btn btn-outline-primary w-100" id="refreshImagesBtn">
                                <i class="bi bi-arrow-clockwise me-1"></i>Actualizar
                            </button>
                        </div>
                    </div>

                    <!-- Upload New Image Section -->
                    <div class="card mb-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-cloud-upload me-2"></i>Subir Nueva Imagen
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-4">
                                    <label for="uploadProductSelect" class="form-label">Producto *</label>
                                    <select class="form-select" id="uploadProductSelect" required>
                                        <option value="">Seleccionar producto...</option>
                                        <!-- Products will be loaded here -->
                                    </select>
                                </div>
                                <div class="col-md-2">
                                    <label for="imageIndex" class="form-label">Índice</label>
                                    <input type="number" class="form-control" id="imageIndex" min="1" max="10" value="1">
                                </div>
                                <div class="col-md-4">
                                    <label for="imageFile" class="form-label">Archivo de Imagen *</label>
                                    <input type="file" class="form-control" id="imageFile" accept="image/*" required>
                                    <div class="form-text">Máximo 5MB. Formatos: JPG, PNG, WebP</div>
                                </div>
                                <div class="col-md-2 d-flex align-items-end">
                                    <div class="form-check">
                                        <input class="form-check-input" type="checkbox" id="setPrimaryImage">
                                        <label class="form-check-label" for="setPrimaryImage">
                                            Principal
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-3">
                                <div class="col-12">
                                    <button class="btn btn-success" id="uploadImageBtn">
                                        <i class="bi bi-upload me-2"></i>Subir Imagen
                                    </button>
                                    <div class="progress mt-2" id="uploadProgress" style="display: none;">
                                        <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Images Gallery -->
                    <div class="card">
                        <div class="card-header bg-light d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">
                                <i class="bi bi-grid-3x3-gap me-2"></i>Galería de Imágenes
                            </h6>
                            <div class="d-flex align-items-center">
                                <small class="text-muted me-3" id="imagesCount">0 imágenes</small>
                                <div class="btn-group btn-group-sm">
                                    <button class="btn btn-outline-secondary" id="viewModeGrid" title="Vista de Cuadrícula">
                                        <i class="bi bi-grid-3x3-gap"></i>
                                    </button>
                                    <button class="btn btn-outline-secondary" id="viewModeList" title="Vista de Lista">
                                        <i class="bi bi-list"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Loading indicator -->
                            <div id="imagesLoading" class="text-center py-4">
                                <div class="spinner-border text-primary" role="status">
                                    <span class="visually-hidden">Cargando imágenes...</span>
                                </div>
                                <p class="mt-2 text-muted">Cargando galería de imágenes...</p>
                            </div>

                            <!-- Images container -->
                            <div id="imagesContainer" class="row" style="display: none;">
                                <!-- Images will be loaded here dynamically -->
                            </div>

                            <!-- Empty state -->
                            <div id="imagesEmpty" class="text-center py-5" style="display: none;">
                                <i class="bi bi-images display-1 text-muted mb-3"></i>
                                <h5 class="text-muted">No hay imágenes</h5>
                                <p class="text-muted">No se encontraron imágenes con los filtros aplicados</p>
                            </div>

                            <!-- Pagination -->
                            <div id="imagesPagination" class="d-flex justify-content-center mt-4" style="display: none;">
                                <nav aria-label="Paginación de imágenes">
                                    <ul class="pagination">
                                        <!-- Pagination will be generated here -->
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- User Creation Modal -->
    <div class="modal fade" id="userModal" tabindex="-1" aria-labelledby="userModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="userModalLabel">Crear Nuevo Usuario</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- Message Area -->
                    <div id="userMessageArea" class="alert-container mb-3" style="display: none;">
                        <div id="userMessage" class="alert" role="alert"></div>
                    </div>

                    <form id="userForm">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userEmail" class="form-label">Email *</label>
                                    <input type="email" class="form-control" id="userEmail" required
                                           placeholder="usuario@ejemplo.com">
                                    <div class="form-text">Email único para el usuario</div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userFullName" class="form-label">Nombre Completo *</label>
                                    <input type="text" class="form-control" id="userFullName" required
                                           placeholder="Juan Pérez">
                                    <div class="form-text">Nombre completo del usuario</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userPassword" class="form-label">Contraseña *</label>
                                    <input type="password" class="form-control" id="userPassword" required
                                           placeholder="Mínimo 8 caracteres">
                                    <div class="form-text">Debe contener mayúscula, minúscula y número</div>
                                    <div id="passwordStrength" class="password-strength" style="display: none;"></div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userPhone" class="form-label">Teléfono</label>
                                    <input type="tel" class="form-control" id="userPhone"
                                           placeholder="+58 412 123 4567">
                                    <div class="form-text">Opcional, formato internacional</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label for="userRole" class="form-label">Rol *</label>
                                    <select class="form-select" id="userRole" required>
                                        <option value="">Seleccionar rol...</option>
                                        <option value="user">Usuario</option>
                                        <option value="admin">Administrador</option>
                                        <option value="support">Soporte</option>
                                    </select>
                                    <div class="form-text">Nivel de acceso del usuario</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="userIsActive" checked>
                                    <label class="form-check-label" for="userIsActive">
                                        Usuario activo
                                    </label>
                                    <div class="form-text">Puede iniciar sesión</div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="mb-3 form-check">
                                    <input type="checkbox" class="form-check-input" id="userEmailVerified">
                                    <label class="form-check-label" for="userEmailVerified">
                                        Email verificado
                                    </label>
                                    <div class="form-text">Email confirmado</div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveUserBtn">Crear Usuario</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order Details Modal -->
    <div class="modal fade" id="orderDetailsModal" tabindex="-1" aria-labelledby="orderDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="orderDetailsModalLabel">
                        <i class="bi bi-receipt me-2"></i>Detalles del Pedido #<span id="orderDetailsId"></span>
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <!-- Order Status and Actions -->
                    <div class="row mb-4">
                        <div class="col-md-8">
                            <div class="d-flex align-items-center gap-3">
                                <div>
                                    <h6 class="mb-1">Estado del Pedido</h6>
                                    <span class="badge fs-6" id="orderDetailsStatusBadge">Cargando...</span>
                                </div>
                                <div>
                                    <h6 class="mb-1">Fecha del Pedido</h6>
                                    <small class="text-muted" id="orderDetailsCreatedAt">Cargando...</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4 text-end">
                            <h6 class="mb-2">Cambiar Estado</h6>
                            <select class="form-select" id="orderStatusSelect" style="max-width: 200px;">
                                <option value="pending">Pendiente</option>
                                <option value="confirmed">Confirmado</option>
                                <option value="preparing">Preparando</option>
                                <option value="ready">Listo</option>
                                <option value="delivered">Entregado</option>
                                <option value="cancelled">Cancelado</option>
                            </select>
                            <button class="btn btn-primary btn-sm mt-2" id="updateOrderStatusBtn">
                                <i class="bi bi-check-circle me-1"></i>Actualizar Estado
                            </button>
                        </div>
                    </div>

                    <!-- Customer Information -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card border-primary">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">
                                        <i class="bi bi-person me-2"></i>Información del Cliente
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <strong>Nombre:</strong><br>
                                            <span id="orderDetailsCustomerName">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Email:</strong><br>
                                            <span id="orderDetailsCustomerEmail">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Teléfono:</strong><br>
                                            <span id="orderDetailsCustomerPhone">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Usuario ID:</strong><br>
                                            <span id="orderDetailsUserId">Cargando...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Delivery Information -->
                        <div class="col-md-6">
                            <div class="card border-success">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">
                                        <i class="bi bi-geo-alt me-2"></i>Información de Entrega
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <strong>Dirección:</strong><br>
                                            <span id="orderDetailsDeliveryAddress">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Ciudad:</strong><br>
                                            <span id="orderDetailsDeliveryCity">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Fecha de Entrega:</strong><br>
                                            <span id="orderDetailsDeliveryDate">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Hora:</strong><br>
                                            <span id="orderDetailsDeliveryTimeSlot">Cargando...</span>
                                        </div>
                                        <div class="col-12">
                                            <strong>Instrucciones:</strong><br>
                                            <span id="orderDetailsDeliveryNotes">Cargando...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Order Items -->
                    <div class="card border-info mb-4">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-basket me-2"></i>Productos del Pedido
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-sm">
                                    <thead>
                                        <tr>
                                            <th>Producto</th>
                                            <th class="text-center">Cant.</th>
                                            <th class="text-end">Precio Unit.</th>
                                            <th class="text-end">Subtotal</th>
                                        </tr>
                                    </thead>
                                    <tbody id="orderItemsTableBody">
                                        <tr>
                                            <td colspan="4" class="text-center text-muted">
                                                <div class="spinner-border spinner-border-sm" role="status"></div>
                                                Cargando productos...
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr class="table-light">
                                            <th colspan="3" class="text-end">Total del Pedido:</th>
                                            <th class="text-end" id="orderDetailsTotal">Cargando...</th>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Payment Information -->
                    <div class="row mb-4">
                        <div class="col-md-6">
                            <div class="card border-warning">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">
                                        <i class="bi bi-credit-card me-2"></i>Información de Pago
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-sm-6">
                                            <strong>Estado:</strong><br>
                                            <span id="orderDetailsPaymentStatus">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Método:</strong><br>
                                            <span id="orderDetailsPaymentMethod">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Monto USD:</strong><br>
                                            <span id="orderDetailsPaymentAmountUSD">Cargando...</span>
                                        </div>
                                        <div class="col-sm-6">
                                            <strong>Monto VES:</strong><br>
                                            <span id="orderDetailsPaymentAmountVES">Cargando...</span>
                                        </div>
                                        <div class="col-12">
                                            <strong>Fecha de Pago:</strong><br>
                                            <span id="orderDetailsPaymentDate">Cargando...</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Admin Notes -->
                        <div class="col-md-6">
                            <div class="card border-secondary">
                                <div class="card-header bg-light">
                                    <h6 class="mb-0">
                                        <i class="bi bi-sticky me-2"></i>Notas Administrativas
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label for="orderAdminNotes" class="form-label">Notas Internas</label>
                                        <textarea class="form-control" id="orderAdminNotes" rows="3" placeholder="Agregar notas administrativas..."></textarea>
                                    </div>
                                    <button class="btn btn-outline-secondary btn-sm" id="saveAdminNotesBtn">
                                        <i class="bi bi-save me-1"></i>Guardar Notas
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Order History -->
                    <div class="card border-dark">
                        <div class="card-header bg-light">
                            <h6 class="mb-0">
                                <i class="bi bi-clock-history me-2"></i>Historial de Estados
                            </h6>
                        </div>
                        <div class="card-body">
                            <div id="orderStatusHistory">
                                <div class="text-center text-muted">
                                    <div class="spinner-border spinner-border-sm" role="status"></div>
                                    Cargando historial...
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    <div class="d-flex gap-2">
                        <button type="button" class="btn btn-warning" id="printOrderBtn">
                            <i class="bi bi-printer me-1"></i>Imprimir
                        </button>
                        <button type="button" class="btn btn-danger" id="cancelOrderBtn" style="display: none;">
                            <i class="bi bi-x-circle me-1"></i>Cancelar Pedido
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scroll optimization -->
    <script type="module" src="/dist/frontend/scroll-effects-fix.js"></script>
</body>
</html>